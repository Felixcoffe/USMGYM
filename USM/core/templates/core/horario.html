{% extends 'core/base.html' %}
{% load static %}

{% block content %}

<!DOCTYPE html>
<html>

<head>
    <style>
        .horario {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(11, 1fr);
            grid-gap: 5px;
            padding: 10px;
            margin: 0 auto;
            /* Centrar la tabla */
        }

        .horario div {
            background-color: #f2f2f2;
            padding: 10px;
            text-align: center;
        }

        .horario button {
            padding: 10px;
            /* Aumentar el tamaño de los botones */
            font-size: 16px;
            /* Aumentar el tamaño de la fuente de los botones */
            transition: background-color 0.3s;
            /* Transición suave para el cambio de color */
        }

        .disponibles {
            background-color: rgb(122, 228, 122);
            /* Color verde para bloques disponibles */
        }

        .no-disponibles {
            background-color: rgb(241, 98, 98);
            /* Color rojo para bloques no disponibles */
        }

        .parcialmente-disponibles {
            background-color: rgb(244, 198, 82);
            /* Color amarillo para bloques parcialmente disponibles */
        }

        .horario button:hover {
            background-color: #ccc;
            /* Color del botón al pasar el mouse encima */
        }

        .popup {
            display: none;
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            width: 400px;
            border: 1px solid black;
            border-radius: 5px;
        }

        /* Estilos para el botón */
        .button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h1>Horario</h1>
    <h2>{{ dia_actual }}</h2>

    <table>
        <thead>
            <tr>
                <th></th>
                {% for dia in dias %}
                <th>{{ dia }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for hora in horas %}
            <tr>
                <td>Bloque {{ hora }}</td>
                {% for dia in dias %}
                <td>
                    {% if dia != 'Sábado' and dia != 'Domingo' %}
                    {% for horario in horarios %}
                    {% if horario.fecha.weekday == forloop.counter0 %}
                    {% if horario.bloques_disponibles == horario.bloques_totales %}
                    <div>
                        <button class="disponibles" onclick="mostrarFormulario()">{{ horario.bloques_disponibles }} /
                            {{horario.bloques_totales}}</button>
                        <div id="popupForm" class="popup">
                            <h2>Formulario UTFSM</h2>
                            <form>
                                <label for="usuario">Usuario:</label>
                                <input type="text" id="usuario" name="usuario" required><br><br>

                                <label for="rol_usm">Rol USM:</label>
                                <input type="text" id="rol_usm" name="rol_usm" required><br><br>

                                <label for="rut">RUT:</label>
                                <input type="text" id="rut" name="rut" required><br><br>

                                <label for="nombre">Nombre:</label>
                                <input type="text" id="nombre" name="nombre" required><br><br>

                                <label for="carrera">Carrera:</label>
                                <input type="text" id="carrera" name="carrera" required><br><br>

                                <input type="submit" value="Enviar">
                            </form>
                        </div>
                    </div>
                    {% elif horario.bloques_disponibles == 0 %}
                    <div>
                        <button class="no-disponibles">{{ horario.bloques_disponibles }} /
                            {{horario.bloques_totales}}</button>
                    </div>
                    {% else %}
                    <div>
                        <button class="parcialmente-disponibles"
                            onclick="mostrarFormulario()">{{horario.bloques_disponibles }} /
                            {{horario.bloques_totales}}</button>
                        <script>
                            function mostrarFormulario() {
                                var popup = document.getElementById("popupForm");
                                popup.style.display = "block";
                            }
                        </script>
                    </div>
                    {% endif %}
                    {% else %}
                    <div></div>
                    {% endif %}
                    {% endfor %}
                    {% endif %}
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

</body>
<script>
    function mostrarFormulario() {
        var popup = document.getElementById("popupForm");
        popup.style.display = "block";
    }
</script>

</html>

{% endblock %}